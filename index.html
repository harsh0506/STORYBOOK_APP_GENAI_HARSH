<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StoryCraft - Interactive Story Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Poppins:wght@300;400;600&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
        }

        .title {
            font-family: 'Fredoka One', cursive;
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0% {
                transform: translate(0, 0px);
            }

            50% {
                transform: translate(0, 15px);
            }

            100% {
                transform: translate(0, -0px);
            }
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            display: none;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body
    class="min-h-screen flex  items-center justify-center p-4"
    style="background-image: url('{{ url_for('static', filename='images/bg1.jpg') }}'), linear-gradient(to bottom right, #8e44ad, #e74c3c);flex-direction:column; background-size: cover; background-position: center;">
    <div class="bg-white p-6 rounded-3xl shadow-2xl w-full max-w-xl">

        <div class="flex flex-col md:flex-row items-center justify-between mb-8">
            <h1 class="title text-xl md:text-4xl font-bold text-purple-600 mb-4 md:mb-0">StoryCraft</h1>

        </div>



        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div
            class="mb-4 p-4 rounded-md {% if category == 'error' %}bg-red-100 text-red-700{% else %}bg-green-100 text-green-700{% endif %}">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}

        <div class="mb-4">
            <form action="/" method="post" class="space-y-4" onsubmit="return submitForm()" id="storyForm">

                <textarea name="prompt" id="prompt"
                    placeholder="Enter a story prompt (e.g., Difference Between Metals and Non-Metals)"
                    class="w-full p-4 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:outline-none focus:border-purple-500 transition duration-300"
                    required oninput="updateProgressBar()"></textarea>

                <span class="absolute right-4 top-4 text-2xl"><svg xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1"
                        viewBox="0 0 341.956 341.956" xml:space="preserve" fill="#000000">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <g>
                                <path style="fill:#a537c3;"
                                    d="M10.655,335.932l-3.984-3.984c-8.032-8.032-8.032-21.056,0-29.088L211.286,98.245 c8.032-8.032,21.056-8.032,29.088,0l3.984,3.984c8.032,8.032,8.032,21.056,0,29.088L39.743,335.932 C31.71,343.964,18.687,343.964,10.655,335.932z">
                                </path>
                                <path style="fill:#8c38a3;"
                                    d="M151.869,157.662L6.671,302.86c-8.032,8.032-8.032,21.056,0,29.088l3.984,3.984 c8.032,8.032,21.056,8.032,29.088,0l112.126-112.126V157.662z">
                                </path>
                                <path style="fill:#f62cc0;"
                                    d="M209.459,166.215l34.899-34.899c8.032-8.032,8.032-21.056,0-29.088l-3.984-3.984 c-8.032-8.032-21.056-8.032-29.088,0l-34.899,34.899L209.459,166.215z">
                                </path>
                                <path style="fill:#F8B242;"
                                    d="M280.346,76.043c-3.839,0-7.658-1.445-10.587-4.374c-5.858-5.857-5.838-15.336,0.019-21.193 l23.22-23.22c5.857-5.857,15.356-5.857,21.213,0c5.858,5.857,5.858,15.355,0,21.213l-23.22,23.22 C288.063,74.618,284.185,76.043,280.346,76.043z">
                                </path>
                                <path style="fill:#F8B242;"
                                    d="M229.462,69.272c-7.257,0-13.636-5.276-14.799-12.671l-6.176-39.267 C207.2,9.151,212.79,1.473,220.974,0.186c8.183-1.293,15.861,4.303,17.148,12.486l6.176,39.267 c1.287,8.184-4.304,15.861-12.487,17.148C231.022,69.212,230.237,69.272,229.462,69.272z">
                                </path>
                                <path style="fill:#F8B242;"
                                    d="M326.326,133.008c-0.775,0-1.56-0.06-2.35-0.185l-39.266-6.177 c-8.184-1.287-13.774-8.965-12.487-17.148c1.287-8.183,8.961-13.789,17.149-12.486l39.266,6.177 c8.184,1.287,13.774,8.965,12.487,17.148C339.962,127.731,333.582,133.008,326.326,133.008z">
                                </path>
                                <g>
                                    <path style="fill:#F8B242;"
                                        d="M175.525,89.405c-3.839,0-7.597-1.546-10.525-4.475l-25.467-25.467 c-5.858-5.858-5.858-15.356,0-21.213c5.857-5.857,15.356-5.858,21.213,0l25.467,25.467c5.858,5.858,5.817,15.396-0.041,21.254 C183.244,87.9,179.364,89.405,175.525,89.405z">
                                    </path>
                                    <path style="fill:#D09838;"
                                        d="M151.869,33.968c-4.393-0.507-8.966,0.913-12.335,4.282c-5.858,5.857-5.858,15.355,0,21.213 l12.335,12.335V33.968z">
                                    </path>
                                    <path style="fill:#F8B242;"
                                        d="M292.372,206.252c-3.839,0-7.597-1.546-10.525-4.475l-25.467-25.467 c-5.858-5.858-5.858-15.356,0-21.213c5.857-5.857,15.356-5.858,21.213,0l25.467,25.467c5.858,5.858,5.817,15.396-0.041,21.254 C300.09,204.747,296.211,206.252,292.372,206.252z">
                                    </path>
                                </g>
                            </g>
                        </g>
                    </svg></span>


                <div class="relative w-full h-2 bg-gray-200 rounded-full overflow-hidden">
                    <div id="error-message" class="mt-1 text-red-500"></div>
                    <div id="progress-bar"
                        class="absolute bottom-0 left-0 h-full transition-all duration-300 ease-in-out"></div>
                </div>

                <button type="submit" id="submitBtn"
                    class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-4 rounded-full hover:from-purple-600 hover:to-pink-600 transition duration-300 w-full text-lg font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                    Create Stories!
                </button>
            </form>
        </div>

        <div id="loader" class="loader mt-8"></div>

        <div class="mt-12">
            <h2 class="text-2xl font-bold mb-6 text-purple-600">Your Story Collection</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for storybook in storybooks %}
                <a href="{{ url_for('view_storybook', relative_path=storybook.path) }}"
                    class="block p-6 bg-gradient-to-br from-yellow-100 to-yellow-200 rounded-xl shadow-md hover:shadow-lg transition duration-300 transform hover:-translate-y-1">
                    <h3 class="text-lg font-semibold text-purple-700 mb-2">{{ storybook.title }}</h3>
                    <p class="text-sm text-gray-600">Click to read your adventure!</p>
                </a>
                {% endfor %}
            </div>
        </div>

       

    </div>
    <footer class="bg-gray-200 p-4 mt-8">
        <div class="container mx-auto text-center">
            &copy; 2024 StoryBook AI App ,<br> <b>Created by Harsh Joshi</b>
        </div>
    </footer>

    <script>

        function submitForm() {
            var prompt = document.getElementById('prompt').value;
            if (prompt.trim().split(/\s+/).filter(Boolean).length <= 1) {
                gsap.to("#prompt", { duration: 0.1, x: 10, yoyo: true, repeat: 5 });
                return false;
            }

            // Allow the form to submit normally
            return true;
        }

        // Animate elements on page load
        window.addEventListener('load', () => {
            gsap.from(".title", { duration: 1, y: -50, opacity: 0, ease: "back" });
            gsap.from("form", { duration: 1, y: 50, opacity: 0, delay: 0.5, ease: "back" });
            gsap.from(".grid", { duration: 1, opacity: 0, delay: 1, stagger: 0.1 });
        });

        
        const promptInput = document.getElementById('prompt');
        const progressBar = document.getElementById('progress-bar');
        const errorMessage = document.getElementById('error-message');

        function updateProgressBar() {
            const words = promptInput.value.trim().split(/\s+/).filter(Boolean);
            const wordCount = words.length;
            let color, width;

            if (wordCount <= 1) {
                color = '#EF4444';  // Tailwind red-500
                width = '20%';
                errorMessage.textContent = 'Please add more words (aim for green)';
            } else if (wordCount >= 2 && wordCount <= 5) {
                color = '#FBBF24';  // Tailwind yellow-400
                width = '50%';
                errorMessage.textContent = 'Getting better, but try adding more detail';
            } else {
                color = '#10B981';  // Tailwind green-500
                width = '100%';
                errorMessage.textContent = '';
            }

            progressBar.style.backgroundColor = color;
            progressBar.style.width = width;
        }


    </script>


   
</body>

</html>
